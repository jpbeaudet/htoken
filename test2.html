<!-- Add the following HTML to the "form-container" div to display the Mint, Burn, and Transfer forms -->

<form class="mint-form" id="mint-form">
  <label for="mint-value">Mint value:</label>
  <input type="text" id="mint-value" />
  <button type="submit" class="button">Mint</button>
</form>

<form class="burn-form" id="burn-form">
  <label for="burn-value">Burn value:</label>
  <input type="text" id="burn-value" />
  <button type="submit" class="button">Burn</button>
</form>

<form class="transfer-form" id="transfer-form">
  <label for="transfer-recipient">Recipient:</label>
  <input type="text" id="transfer-recipient" />
  <label for="transfer-amount">Amount:</label>
  <input type="text" id="transfer-amount" />
  <button type="submit" class="button">Transfer</button>
</form>

<!-- Add the following JavaScript to the script tag to handle Mint, Burn, and Transfer forms -->
<script>
  // Add event listeners to handle the Mint, Burn, and Transfer forms
  document.getElementById("mint-form").addEventListener("submit", handleMintForm);
  document.getElementById("burn-form").addEventListener("submit", handleBurnForm);
  document.getElementById("transfer-form").addEventListener("submit", handleTransferForm);

  // Handle the "Mint" form submission
  async function handleMintForm(event) {
    // Prevent the form from reloading the page
    event.preventDefault();

    // Get the mint value from the form
    let value = document.getElementById("mint-value").value;

    // Call the mint function on the HToken contract
    try {
      await htoken.methods.mint(value).send({ from: account });
    } catch (error) {
      // Display the error message
      document.getElementById("error").innerHTML = error.message;
      return;
    }

    // Clear the error message
    document.getElementById("error").innerHTML = "";

    //
// Clear the error message
document.getElementById("error").innerHTML = "";

// Display the updated list of HTokens
displayHTokenList();
}

// Handle the "Swap" form submission
async function handleSwapForm(event) {
// Prevent the form from reloading the page
event.preventDefault();
  // Get the from and to HTokens and the amount to swap from the form
let fromHTK = document.getElementById("fromHTK").value;
let toHTK = document.getElementById("toHTK").value;
let amount = document.getElementById("fromAmount").value;

// Call the swapExactHTKForHTK function on the HTokenRouter contract
try {
  await router.methods.swapExactHTKForHTK(fromHTK, amount, toHTK).send({ from: account });
} catch (error) {
  // Display the error message
  document.getElementById("error").innerHTML = error.message;
  return;
}

// Clear the error message
document.getElementById("error").innerHTML = "";

// Display the updated balance
displayBalance();
}

// Display the list of HTokens
async function displayHTokenList() {
// Clear the current list of HTokens
let fromHTKSelect = document.getElementById("fromHTK");
fromHTKSelect.innerHTML = '<option value="" disabled selected>Select HTK</option>';
let toHTKSelect = document.getElementById("toHTK");
toHTKSelect.innerHTML = '<option value="" disabled selected>Select HTK</option>';
  // Get the number of HTokens
let htokenCount = await factory.methods.getHTokenCount().call();

// Display the name and symbol of each HToken in the swap form dropdowns
for (let i = 0; i < htokenCount; i++) {
  let htokenAddress = await factory.methods.getHTokenAtIndex(i).call();
  let htokenName = await factory.methods.getHTokenNameAtIndex(i).call();
  let htokenSymbol = await factory.methods.getHTokenSymbolAtIndex(i).call();

  let option = document.createElement("option");
  option.value = htokenAddress;
  option.text = `${htokenName} (${htokenSymbol})`;
  fromHTKSelect.add(option);
  option = document.createElement("option");
  option.value = htokenAddress;
  option.text = `${htokenName} (${htokenSymbol})`;
  toHTKSelect.add(option);
}
}

// Initialize the Web3 object and the HToken contract object
async function init() {
// Check if the Web3 object is already available (e.g. MetaMask)
if (typeof web3 !== "undefined") {
web3 = new Web3(web3.currentProvider);
} else {
// If not, create a new Web3 object
web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:7545"));
}
  // Get the current account
account = (await web3.eth.getAccounts())[0];

// Initialize the HToken contract object
htoken = new web3.eth.Contract(contractABI, contractAddress);

// Initialize the HTokenFactory contract object
factory = new web3.eth.Contract(factoryABI, factoryAddress);

// Initialize the HTokenRouter contract object
router = new web3.eth.Contract(routerABI, routerAddress);
}

// Call the displayBalance function when the page loads
window.onload = function() {
init();
displayBalance();
displayHTokenList();
};
</script>

</body>
</html>
